# TodoApi: REST API на ASP.NET Core Minimal API

Проект представляет собой REST API для управления списком задач (`Todo`). API разработано с использованием стиля Minimal API в ASP.NET Core и включает в себя систему аутентификации пользователей и набор тестов.

## Функционал

- **Управление задачами:** Реализованы все CRUD-операции (создание, чтение, обновление, удаление) для задач.
- **Управление пользователями:** Конечные точки для регистрации и входа пользователей.
- **Безопасность:**
  - Аутентификация реализована с помощью **JWT Bearer токенов**.
  - Доступ к операциям с задачами разрешен только аутентифицированным пользователям.
  - Реализована авторизация на уровне данных: пользователь может получать и изменять **только свои** задачи.
- **Документация API:** Интерактивная документация доступна через **Swagger (OpenAPI)**.

## Технологический стек и архитектура

Проект построен на **.NET 9**. Основной стиль — **Minimal API**, код запуска и конфигурации структурирован с помощью **методов расширения** для повышения читаемости.

- **Фреймворк:** ASP.NET Core
- **База данных:** Entity Framework Core с провайдером **SQLite**. Схема БД управляется через миграции.
- **Аутентификация:** ASP.NET Core Identity для управления пользователями и JWT для аутентификации запросов.
- **Валидация:** **FluentValidation** для проверки входящих DTO.
- **Маппинг:** **AutoMapper** для преобразования между доменными моделями и DTO.
- **Архитектурные паттерны:**
  - **Сервисный слой (Service Layer):** Бизнес-логика вынесена в отдельные классы-сервисы.
  - **DTO (Data Transfer Object):** Используются для определения четкого контракта API.
  - **Dependency Injection (DI):** Все зависимости (сервисы, DbContext) регистрируются и внедряются через встроенный DI-контейнер.
- **Middleware:**
  - Настроен **CORS** для взаимодействия с веб-клиентами.
  - Реализована глобальная обработка ошибок.
  - Добавлен кастомный Middleware для логирования HTTP-запросов.
  - Настроена отдача статических файлов (`wwwroot`).

## Тестирование

Решение содержит два тестовых проекта для обеспечения качества кода.

- **`TodoApi.Tests.Unit` (Юнит-тесты):**

  - Используется фреймворк **xUnit**.
  - Зависимости изолируются с помощью **Moq**.
  - `DbContext` заменяется на **In-Memory Database** для быстрой и изолированной проверки бизнес-логики в сервисах.

- **`TodoApi.Tests.Integration` (Интеграционные тесты):**
  - Используется **xUnit** и `WebApplicationFactory` для запуска приложения в памяти.
  - Тесты отправляют реальные HTTP-запросы к конечным точкам.
  - Проверки (`Asserts`) написаны с использованием библиотеки **FluentAssertions**.

## Запуск проекта

1.  **Требования:** .NET SDK (версия 9.0 или выше).
2.  **Клонирование:** `git clone https://github.com/Calcifer08/todo-minimal-api.git`
3.  **Переход в директорию:** `cd TodoApiSolution`
4.  **Создание базы данных:**
    ```bash
    dotnet ef database update --project src/TodoApi
    ```
5.  **Запуск API:**
    ```bash
    dotnet run --project src/TodoApi
    ```
6.  **Доступ к Swagger:** Откройте в браузере `http://localhost:<порт>/swagger`.

## Запуск тестов

Для запуска всех юнит и интеграционных тестов выполните команду из **корневой папки решения** (`TodoApiSolution`):

```bash
dotnet test
```
